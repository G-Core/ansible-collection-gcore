---
- block:
    - name: Gather information about all images
      gcore.cloud.image_info:
        api_key: "{{ GCORE_API_KEY }}"
        api_host: "{{ GCORE_API_HOST }}"
        project_id: "{{ GCORE_PROJECT_ID | int }}"
        region_id: "{{ GCORE_REGION_ID | int }}"
      register: result
    
    - name: Gather information about specific image by ID
      gcore.cloud.image_info:
        api_key: "{{ GCORE_API_KEY }}"
        api_host: "{{ GCORE_API_HOST }}"
        project_id: "{{ GCORE_PROJECT_ID }}"
        region_id: "{{ GCORE_REGION_ID }}"
        image_id: "{{ result.data[0]['id'] }}"
      register: result

    - name: Verify image info fetched
      ansible.builtin.assert:
        that:
          - not result.changed
          - result.data is defined
