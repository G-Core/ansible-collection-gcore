- block:
    - name: Missing fields for subnet interface
      gcore.cloud.instance:
        api_key: "{{ API_KEY }}"
        api_host: "{{ API_HOST }}"
        project_id: "{{ PROJECT_ID }}"
        region_id: "{{ REGION_ID }}"
        command: create
        names: ["test-instance"]
        flavor: "g1-standard-1-2"
        volumes: [{}]
      register: result
      ignore_errors: True
    - name: Fail command
      assert:
        that:
          - result is failed
          - result.msg.startswith('missing required arguments')

    - name: Instance quota exceeded
      gcore.cloud.instance_quota_info:
        api_key: "{{ API_KEY }}"
        api_host: "{{ API_HOST }}"
        project_id: "{{ PROJECT_ID }}"
        region_id: "{{ REGION_ID }}"
        flavor: "g1-standard-1-2"
        names: ["inst1"]
        volumes: [{'size': 10000, 'source': 'new-volume', 'type_name': 'standard'}]
        interfaces: [{'type': 'external'}]
      register: quota
    - name: Instance overquota validation
      assert:
        that:
          - quota.data.volume_size_requested == 10000
          - quota.data.volume_size_limit < 10000
